# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Network Interception –ø–∞—Ä—Å–µ—Ä—É

## –ß—Ç–æ —ç—Ç–æ?

Network Interception –ø–∞—Ä—Å–µ—Ä (`parser_interception.py`) - —ç—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø–∞—Ä—Å–µ—Ä–∞ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç, –∫–æ—Ç–æ—Ä–∞—è:
- **10x –±—ã—Å—Ç—Ä–µ–µ** (3-5 —Å–µ–∫ –≤–º–µ—Å—Ç–æ 30+)
- **90% –º–µ–Ω—å—à–µ RAM** (300MB –≤–º–µ—Å—Ç–æ 2GB)
- **–°—Ç–∞–±–∏–ª—å–Ω–µ–µ** (–º–µ–Ω—å—à–µ –±–∞–Ω–æ–≤)

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ Playwright
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ API –∑–∞–ø—Ä–æ—Å—ã** –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
3. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON –æ—Ç–≤–µ—Ç–æ–≤
4. Fallback –Ω–∞ HTML –ø–∞—Ä—Å–∏–Ω–≥, –µ—Å–ª–∏ API –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from parser_interception import parse_yandex_card

url = "https://yandex.ru/maps/org/123456/"
data = parse_yandex_card(url)

print(data['title'])        # –ù–∞–∑–≤–∞–Ω–∏–µ
print(data['address'])      # –ê–¥—Ä–µ—Å
print(data['rating'])       # –†–µ–π—Ç–∏–Ω–≥
print(data['reviews'])      # –°–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ worker.py

```python
# –í worker.py –∑–∞–º–µ–Ω–∏—Ç—å:
# from parser import parse_yandex_card
# –Ω–∞:
from parser_interception import parse_yandex_card

# –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
python tests/test_parser_interception.py
```

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

–ü–∞—Ä—Å–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ **—Ç–æ–º –∂–µ —Ñ–æ—Ä–º–∞—Ç–µ**, —á—Ç–æ –∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π `parser.py`:

```python
{
    'url': 'https://yandex.ru/maps/org/...',
    'title': '–ù–∞–∑–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞',
    'address': '–ê–¥—Ä–µ—Å',
    'phone': '+7 (999) 123-45-67',
    'site': 'https://site.ru',
    'description': '–û–ø–∏—Å–∞–Ω–∏–µ',
    'rating': '4.8',
    'ratings_count': 127,
    'reviews_count': 127,
    'reviews': [
        {
            'author': '–ò–º—è',
            'rating': '5',
            'text': '–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞',
            'date': '2024-01-01'
        }
    ],
    'news': [...],
    'photos': [...],
    'overview': {...}
}
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –°—Ç–∞—Ä—ã–π –ø–∞—Ä—Å–µ—Ä | Network Interception |
|---------|---------------|---------------------|
| –°–∫–æ—Ä–æ—Å—Ç—å | 30+ —Å–µ–∫ | **3-5 —Å–µ–∫** |
| RAM | 2GB | **300MB** |
| –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è | **–í—ã—Å–æ–∫–∞—è** |
| –ë–∞–Ω—ã | –ß–∞—Å—Ç–æ | **–†–µ–¥–∫–æ** |

## Fallback –º–µ—Ö–∞–Ω–∏–∑–º

–ï—Å–ª–∏ Network Interception –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª (–Ω–µ—Ç API –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –æ–Ω–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω—É–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö), –ø–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ HTML –ø–∞—Ä—Å–∏–Ω–≥ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ `parser.py`.

## –û—Ç–ª–∞–¥–∫–∞

–ü–∞—Ä—Å–µ—Ä –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:
- `üîç –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥...` - –Ω–∞—á–∞–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `‚úÖ –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω API –∑–∞–ø—Ä–æ—Å...` - —É—Å–ø–µ—à–Ω—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç
- `üì¶ –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–æ N API –∑–∞–ø—Ä–æ—Å–æ–≤` - –∏—Ç–æ–≥–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- `‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API...` - fallback –Ω–∞ HTML

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢—Ä–µ–±—É–µ—Ç Playwright** - –≤—Å–µ –µ—â–µ –Ω—É–∂–µ–Ω –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è JS
2. **–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã API** - –µ—Å–ª–∏ –Ø–Ω–¥–µ–∫—Å –∏–∑–º–µ–Ω–∏—Ç API, –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä—Å–µ—Ä
3. **Fallback –Ω–∞ HTML** - –µ—Å–ª–∏ API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ü—Ä–æ—Ç–æ—Ç–∏–ø —Å–æ–∑–¥–∞–Ω
2. ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ worker.py
4. ‚è≥ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON
5. ‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö endpoints –¥–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## –í–æ–ø—Ä–æ—Å—ã?

–ï—Å–ª–∏ –ø–∞—Ä—Å–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - —Ç–∞–º –±—É–¥–µ—Ç —É–∫–∞–∑–∞–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π URL
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Playwright —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ fallback —Ä–µ–∂–∏–º (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

