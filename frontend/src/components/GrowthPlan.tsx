import React, { useState } from 'react';
import { Select, SelectTrigger, SelectContent, SelectItem, SelectValue } from '@/components/ui/select';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { CheckCircle2, Circle, ArrowRight } from 'lucide-react';

interface GrowthStage {
  id: string;
  title: string;
  description: string;
  tasks: string[];
  duration: string;
  expectedResult: string;
}

interface BusinessTypePlan {
  type: string;
  label: string;
  stages: GrowthStage[];
}

const businessPlans: BusinessTypePlan[] = [
  {
    type: 'beauty_salon',
    label: 'Салон красоты',
    stages: [
      {
        id: '1',
        title: 'Диагностика и базовая настройка',
        description: 'Анализ текущего состояния карточки, настройка базовых параметров',
        tasks: [
          'Провести аудит карточки на картах',
          'Оптимизировать описание услуг',
          'Добавить качественные фото',
          'Настроить режим работы',
          'Проверить контактные данные'
        ],
        duration: '1-2 недели',
        expectedResult: 'Улучшение видимости карточки, рост запросов на 15-20%'
      },
      {
        id: '2',
        title: 'Оптимизация услуг и прайс-листа',
        description: 'Улучшение формулировок услуг, оптимизация цен',
        tasks: [
          'Оптимизировать названия услуг для SEO',
          'Добавить ключевые слова в описания',
          'Проанализировать цены конкурентов',
          'Создать привлекательные пакетные предложения',
          'Обновить фото услуг'
        ],
        duration: '2-3 недели',
        expectedResult: 'Рост конверсии на 25-30%, увеличение среднего чека на 10-15%'
      },
      {
        id: '3',
        title: 'Работа с отзывами и репутацией',
        description: 'Систематическая работа с отзывами, улучшение рейтинга',
        tasks: [
          'Ответить на все неотвеченные отзывы',
          'Внедрить систему напоминаний клиентам оставлять отзывы',
          'Обработать негативные отзывы',
          'Создать шаблоны ответов на типовые отзывы',
          'Мониторить рейтинг и отзывы еженедельно'
        ],
        duration: '3-4 недели',
        expectedResult: 'Рост рейтинга до 4.5+, увеличение доверия клиентов на 40%'
      },
      {
        id: '4',
        title: 'Контент-маркетинг и новости',
        description: 'Регулярная публикация новостей и обновлений',
        tasks: [
          'Публиковать новости о новых услугах',
          'Рассказывать о мастерах и их достижениях',
          'Анонсировать акции и специальные предложения',
          'Показывать результаты работ',
          'Делиться полезными советами по уходу'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост вовлеченности на 50%, увеличение повторных визитов на 20%'
      },
      {
        id: '5',
        title: 'Масштабирование и автоматизация',
        description: 'Внедрение CRM, автоматизация процессов, расширение',
        tasks: [
          'Настроить CRM для управления клиентами',
          'Внедрить систему онлайн-записи',
          'Автоматизировать напоминания клиентам',
          'Расширить команду мастеров',
          'Открыть дополнительные точки или расширить площадь'
        ],
        duration: '2-3 месяца',
        expectedResult: 'Рост выручки на 50-100%, увеличение клиентской базы в 2 раза'
      }
    ]
  },
  {
    type: 'barbershop',
    label: 'Барбершоп',
    stages: [
      {
        id: '1',
        title: 'Базовая настройка карточки',
        description: 'Оптимизация карточки для привлечения мужской аудитории',
        tasks: [
          'Создать стильное описание барбершопа',
          'Добавить фото интерьера и работ',
          'Указать специализацию (стрижки, бороды, усы)',
          'Настроить режим работы',
          'Указать цены на основные услуги'
        ],
        duration: '1 неделя',
        expectedResult: 'Рост запросов на 20-25%'
      },
      {
        id: '2',
        title: 'Построение мужского сообщества',
        description: 'Создание атмосферы мужского клуба, работа с постоянными клиентами',
        tasks: [
          'Создать программу лояльности для постоянных клиентов',
          'Организовать мужские мероприятия',
          'Вести блог о стиле и уходе',
          'Сотрудничать с местными брендами одежды',
          'Создать атмосферу премиального сервиса'
        ],
        duration: '1-2 месяца',
        expectedResult: 'Рост постоянных клиентов на 40%, увеличение среднего чека на 20%'
      },
      {
        id: '3',
        title: 'Расширение услуг и сервисов',
        description: 'Добавление дополнительных услуг для мужчин',
        tasks: [
          'Добавить услуги по уходу за бородой и усами',
          'Предложить услуги бритья опасной бритвой',
          'Добавить массаж головы и шеи',
          'Предложить уход за кожей лица',
          'Создать пакетные предложения'
        ],
        duration: '2-3 недели',
        expectedResult: 'Увеличение среднего чека на 30-40%'
      },
      {
        id: '4',
        title: 'Работа с репутацией и отзывами',
        description: 'Систематическая работа с отзывами, улучшение рейтинга',
        tasks: [
          'Ответить на все отзывы',
          'Создать систему напоминаний оставлять отзывы',
          'Обработать негативные отзывы',
          'Показывать лучшие работы в отзывах',
          'Мониторить рейтинг еженедельно'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.7+, увеличение доверия на 50%'
      },
      {
        id: '5',
        title: 'Масштабирование и франшиза',
        description: 'Расширение сети, открытие новых точек',
        tasks: [
          'Настроить систему управления несколькими точками',
          'Стандартизировать процессы и сервисы',
          'Подготовить франшизу',
          'Обучить команду единым стандартам',
          'Открыть новые точки в других районах'
        ],
        duration: '3-6 месяцев',
        expectedResult: 'Рост выручки в 3-5 раз, создание узнаваемого бренда'
      }
    ]
  },
  {
    type: 'spa',
    label: 'SPA/Wellness',
    stages: [
      {
        id: '1',
        title: 'Создание атмосферы релакса',
        description: 'Настройка карточки для передачи атмосферы спокойствия и уюта',
        tasks: [
          'Создать умиротворяющее описание',
          'Добавить фото интерьера и процедур',
          'Указать специализацию (массаж, обертывания, спа-процедуры)',
          'Настроить режим работы',
          'Указать цены и длительность процедур'
        ],
        duration: '1-2 недели',
        expectedResult: 'Рост запросов на 20%'
      },
      {
        id: '2',
        title: 'Разработка программ и пакетов',
        description: 'Создание комплексных программ для клиентов',
        tasks: [
          'Создать программы "День красоты"',
          'Разработать абонементы на курс процедур',
          'Предложить подарочные сертификаты',
          'Создать программы для пар',
          'Разработать корпоративные программы'
        ],
        duration: '2-3 недели',
        expectedResult: 'Увеличение среднего чека на 40-50%'
      },
      {
        id: '3',
        title: 'Работа с отзывами и рекомендациями',
        description: 'Систематическая работа с отзывами, использование рекомендаций',
        tasks: [
          'Ответить на все отзывы',
          'Попросить довольных клиентов оставить отзыв',
          'Создать программу рекомендаций',
          'Показывать результаты до/после',
          'Мониторить рейтинг и отзывы'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.6+, увеличение доверия на 45%'
      },
      {
        id: '4',
        title: 'Контент о здоровье и красоте',
        description: 'Регулярная публикация полезного контента',
        tasks: [
          'Публиковать статьи о здоровье и красоте',
          'Делиться советами по уходу за собой',
          'Рассказывать о процедурах и их пользе',
          'Показывать результаты работ',
          'Анонсировать новые процедуры'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост вовлеченности на 60%, увеличение повторных визитов на 30%'
      },
      {
        id: '5',
        title: 'Расширение и развитие',
        description: 'Добавление новых услуг, расширение команды',
        tasks: [
          'Добавить новые процедуры',
          'Расширить команду специалистов',
          'Улучшить интерьер и оборудование',
          'Внедрить систему онлайн-записи',
          'Создать программу лояльности'
        ],
        duration: '2-3 месяца',
        expectedResult: 'Рост выручки на 60-80%, увеличение клиентской базы в 1.5-2 раза'
      }
    ]
  },
  {
    type: 'nail_studio',
    label: 'Ногтевая студия',
    stages: [
      {
        id: '1',
        title: 'Презентация работ и стилей',
        description: 'Создание привлекательной карточки с примерами работ',
        tasks: [
          'Добавить качественные фото работ',
          'Указать все виды услуг (маникюр, педикюр, дизайн)',
          'Создать описание стилей и техник',
          'Настроить режим работы',
          'Указать цены на услуги'
        ],
        duration: '1 неделя',
        expectedResult: 'Рост запросов на 25%'
      },
      {
        id: '2',
        title: 'Создание коллекций и трендов',
        description: 'Работа с актуальными трендами, создание уникальных дизайнов',
        tasks: [
          'Следить за трендами в дизайне ногтей',
          'Создавать сезонные коллекции',
          'Предлагать индивидуальный дизайн',
          'Показывать работы в соцсетях',
          'Создать галерею лучших работ'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост среднего чека на 20-30%'
      },
      {
        id: '3',
        title: 'Работа с отзывами и рекомендациями',
        description: 'Систематическая работа с отзывами',
        tasks: [
          'Ответить на все отзывы',
          'Попросить клиентов оставлять отзывы с фото',
          'Создать программу рекомендаций',
          'Показывать лучшие работы в отзывах',
          'Мониторить рейтинг'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.7+, увеличение доверия на 50%'
      },
      {
        id: '4',
        title: 'Расширение услуг',
        description: 'Добавление дополнительных услуг',
        tasks: [
          'Добавить услуги по уходу за кожей рук',
          'Предложить наращивание ногтей',
          'Добавить услуги по коррекции бровей',
          'Создать пакетные предложения',
          'Предложить подарочные сертификаты'
        ],
        duration: '1-2 месяца',
        expectedResult: 'Увеличение среднего чека на 35%'
      },
      {
        id: '5',
        title: 'Масштабирование',
        description: 'Расширение команды, открытие новых точек',
        tasks: [
          'Расширить команду мастеров',
          'Открыть дополнительные рабочие места',
          'Внедрить систему онлайн-записи',
          'Создать программу обучения мастеров',
          'Открыть новые точки'
        ],
        duration: '3-6 месяцев',
        expectedResult: 'Рост выручки в 2-3 раза, увеличение клиентской базы в 2 раза'
      }
    ]
  },
  {
    type: 'cosmetology',
    label: 'Косметология',
    stages: [
      {
        id: '1',
        title: 'Демонстрация экспертизы',
        description: 'Создание карточки, демонстрирующей профессионализм',
        tasks: [
          'Указать образование и сертификаты специалистов',
          'Добавить фото оборудования и кабинетов',
          'Описать виды процедур',
          'Указать противопоказания',
          'Настроить режим работы'
        ],
        duration: '1-2 недели',
        expectedResult: 'Рост запросов на 20%'
      },
      {
        id: '2',
        title: 'Результаты до/после',
        description: 'Демонстрация результатов работы',
        tasks: [
          'Добавить фото результатов до/после',
          'Собрать отзывы с результатами',
          'Показывать различные случаи',
          'Демонстрировать разные процедуры',
          'Создать галерею результатов'
        ],
        duration: '2-3 недели',
        expectedResult: 'Рост конверсии на 30%, увеличение доверия на 40%'
      },
      {
        id: '3',
        title: 'Образовательный контент',
        description: 'Создание полезного контента о косметологии',
        tasks: [
          'Публиковать статьи о процедурах',
          'Делиться советами по уходу',
          'Рассказывать о новинках в косметологии',
          'Проводить онлайн-консультации',
          'Создать FAQ по процедурам'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост вовлеченности на 50%, увеличение запросов на 25%'
      },
      {
        id: '4',
        title: 'Работа с отзывами',
        description: 'Систематическая работа с отзывами',
        tasks: [
          'Ответить на все отзывы',
          'Попросить довольных клиентов оставить отзыв',
          'Обработать негативные отзывы',
          'Создать программу рекомендаций',
          'Мониторить рейтинг'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.6+, увеличение доверия на 45%'
      },
      {
        id: '5',
        title: 'Расширение и развитие',
        description: 'Добавление новых процедур, расширение команды',
        tasks: [
          'Добавить новые процедуры',
          'Расширить команду специалистов',
          'Улучшить оборудование',
          'Внедрить систему онлайн-записи',
          'Создать программу лояльности'
        ],
        duration: '2-3 месяца',
        expectedResult: 'Рост выручки на 50-70%, увеличение клиентской базы в 1.5-2 раза'
      }
    ]
  },
  {
    type: 'massage',
    label: 'Массаж',
    stages: [
      {
        id: '1',
        title: 'Презентация видов массажа',
        description: 'Создание карточки с описанием всех видов массажа',
        tasks: [
          'Указать все виды массажа',
          'Добавить фото процедур',
          'Описать показания и противопоказания',
          'Указать длительность и цены',
          'Настроить режим работы'
        ],
        duration: '1 неделя',
        expectedResult: 'Рост запросов на 20%'
      },
      {
        id: '2',
        title: 'Создание программ и курсов',
        description: 'Разработка курсов массажа для клиентов',
        tasks: [
          'Создать курсы лечебного массажа',
          'Разработать программы релаксации',
          'Предложить абонементы',
          'Создать программы для пар',
          'Разработать корпоративные программы'
        ],
        duration: '2-3 недели',
        expectedResult: 'Увеличение среднего чека на 40%'
      },
      {
        id: '3',
        title: 'Работа с отзывами',
        description: 'Систематическая работа с отзывами',
        tasks: [
          'Ответить на все отзывы',
          'Попросить довольных клиентов оставить отзыв',
          'Создать программу рекомендаций',
          'Показывать результаты лечения',
          'Мониторить рейтинг'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.6+, увеличение доверия на 45%'
      },
      {
        id: '4',
        title: 'Образовательный контент',
        description: 'Создание полезного контента о массаже',
        tasks: [
          'Публиковать статьи о пользе массажа',
          'Делиться техниками самомассажа',
          'Рассказывать о разных видах массажа',
          'Показывать результаты лечения',
          'Анонсировать новые услуги'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост вовлеченности на 50%, увеличение повторных визитов на 25%'
      },
      {
        id: '5',
        title: 'Расширение и развитие',
        description: 'Добавление новых услуг, расширение команды',
        tasks: [
          'Добавить новые виды массажа',
          'Расширить команду массажистов',
          'Улучшить оборудование',
          'Внедрить систему онлайн-записи',
          'Создать программу лояльности'
        ],
        duration: '2-3 месяца',
        expectedResult: 'Рост выручки на 50-70%, увеличение клиентской базы в 1.5-2 раза'
      }
    ]
  },
  {
    type: 'brows_lashes',
    label: 'Брови и ресницы',
    stages: [
      {
        id: '1',
        title: 'Галерея работ',
        description: 'Создание привлекательной карточки с примерами работ',
        tasks: [
          'Добавить качественные фото работ',
          'Указать все виды услуг',
          'Создать описание техник',
          'Настроить режим работы',
          'Указать цены'
        ],
        duration: '1 неделя',
        expectedResult: 'Рост запросов на 25%'
      },
      {
        id: '2',
        title: 'Создание трендовых образов',
        description: 'Работа с актуальными трендами',
        tasks: [
          'Следить за трендами в бровях и ресницах',
          'Создавать сезонные коллекции',
          'Предлагать индивидуальные решения',
          'Показывать работы в соцсетях',
          'Создать галерею лучших работ'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост среднего чека на 25%'
      },
      {
        id: '3',
        title: 'Работа с отзывами',
        description: 'Систематическая работа с отзывами',
        tasks: [
          'Ответить на все отзывы',
          'Попросить клиентов оставлять отзывы с фото',
          'Создать программу рекомендаций',
          'Показывать лучшие работы',
          'Мониторить рейтинг'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.7+, увеличение доверия на 50%'
      },
      {
        id: '4',
        title: 'Расширение услуг',
        description: 'Добавление дополнительных услуг',
        tasks: [
          'Добавить услуги по уходу за бровями',
          'Предложить татуаж бровей',
          'Добавить услуги по наращиванию ресниц',
          'Создать пакетные предложения',
          'Предложить подарочные сертификаты'
        ],
        duration: '1-2 месяца',
        expectedResult: 'Увеличение среднего чека на 30%'
      },
      {
        id: '5',
        title: 'Масштабирование',
        description: 'Расширение команды, открытие новых точек',
        tasks: [
          'Расширить команду мастеров',
          'Открыть дополнительные рабочие места',
          'Внедрить систему онлайн-записи',
          'Создать программу обучения',
          'Открыть новые точки'
        ],
        duration: '3-6 месяцев',
        expectedResult: 'Рост выручки в 2-3 раза, увеличение клиентской базы в 2 раза'
      }
    ]
  },
  {
    type: 'makeup',
    label: 'Макияж',
    stages: [
      {
        id: '1',
        title: 'Портфолио работ',
        description: 'Создание карточки с портфолио работ',
        tasks: [
          'Добавить качественные фото работ',
          'Указать все виды макияжа',
          'Создать описание стилей',
          'Настроить режим работы',
          'Указать цены'
        ],
        duration: '1 неделя',
        expectedResult: 'Рост запросов на 25%'
      },
      {
        id: '2',
        title: 'Создание образов для разных случаев',
        description: 'Работа с различными стилями и случаями',
        tasks: [
          'Создать образы для свадеб',
          'Предложить макияж для фотосессий',
          'Разработать вечерние образы',
          'Предложить дневной макияж',
          'Создать галерею образов'
        ],
        duration: '2-3 недели',
        expectedResult: 'Рост среднего чека на 30%'
      },
      {
        id: '3',
        title: 'Работа с отзывами',
        description: 'Систематическая работа с отзывами',
        tasks: [
          'Ответить на все отзывы',
          'Попросить клиентов оставлять отзывы с фото',
          'Создать программу рекомендаций',
          'Показывать лучшие работы',
          'Мониторить рейтинг'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.7+, увеличение доверия на 50%'
      },
      {
        id: '4',
        title: 'Образовательный контент',
        description: 'Создание полезного контента о макияже',
        tasks: [
          'Публиковать туториалы по макияжу',
          'Делиться советами по подбору косметики',
          'Рассказывать о трендах',
          'Показывать процесс создания образа',
          'Анонсировать новые услуги'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост вовлеченности на 50%, увеличение запросов на 20%'
      },
      {
        id: '5',
        title: 'Масштабирование',
        description: 'Расширение команды, открытие новых точек',
        tasks: [
          'Расширить команду визажистов',
          'Открыть студию для фотосессий',
          'Внедрить систему онлайн-записи',
          'Создать программу обучения',
          'Открыть новые точки'
        ],
        duration: '3-6 месяцев',
        expectedResult: 'Рост выручки в 2-3 раза, увеличение клиентской базы в 2 раза'
      }
    ]
  },
  {
    type: 'tanning',
    label: 'Солярий',
    stages: [
      {
        id: '1',
        title: 'Информация о безопасности',
        description: 'Создание карточки с акцентом на безопасность',
        tasks: [
          'Указать типы соляриев',
          'Добавить информацию о безопасности',
          'Описать противопоказания',
          'Указать режим работы',
          'Указать цены и длительность сеансов'
        ],
        duration: '1 неделя',
        expectedResult: 'Рост запросов на 20%'
      },
      {
        id: '2',
        title: 'Создание абонементов и программ',
        description: 'Разработка программ для постоянных клиентов',
        tasks: [
          'Создать абонементы на курс',
          'Разработать программы для разных целей',
          'Предложить подарочные сертификаты',
          'Создать программы для пар',
          'Разработать корпоративные программы'
        ],
        duration: '2-3 недели',
        expectedResult: 'Увеличение среднего чека на 35%'
      },
      {
        id: '3',
        title: 'Работа с отзывами',
        description: 'Систематическая работа с отзывами',
        tasks: [
          'Ответить на все отзывы',
          'Попросить довольных клиентов оставить отзыв',
          'Создать программу рекомендаций',
          'Показывать результаты',
          'Мониторить рейтинг'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.6+, увеличение доверия на 45%'
      },
      {
        id: '4',
        title: 'Образовательный контент',
        description: 'Создание полезного контента о загаре',
        tasks: [
          'Публиковать статьи о безопасном загаре',
          'Делиться советами по уходу за кожей',
          'Рассказывать о пользе витамина D',
          'Показывать результаты',
          'Анонсировать акции'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост вовлеченности на 40%, увеличение повторных визитов на 20%'
      },
      {
        id: '5',
        title: 'Расширение и развитие',
        description: 'Добавление новых услуг, улучшение оборудования',
        tasks: [
          'Улучшить оборудование',
          'Добавить новые типы соляриев',
          'Расширить площадь',
          'Внедрить систему онлайн-записи',
          'Создать программу лояльности'
        ],
        duration: '2-3 месяца',
        expectedResult: 'Рост выручки на 40-60%, увеличение клиентской базы в 1.5 раза'
      }
    ]
  },
  {
    type: 'other',
    label: 'Другое',
    stages: [
      {
        id: '1',
        title: 'Базовая настройка',
        description: 'Создание привлекательной карточки',
        tasks: [
          'Оптимизировать описание бизнеса',
          'Добавить качественные фото',
          'Указать все услуги',
          'Настроить режим работы',
          'Указать контактные данные'
        ],
        duration: '1-2 недели',
        expectedResult: 'Рост запросов на 15-20%'
      },
      {
        id: '2',
        title: 'Оптимизация услуг',
        description: 'Улучшение формулировок услуг',
        tasks: [
          'Оптимизировать названия услуг',
          'Добавить ключевые слова',
          'Проанализировать конкурентов',
          'Создать привлекательные предложения',
          'Обновить фото'
        ],
        duration: '2-3 недели',
        expectedResult: 'Рост конверсии на 25-30%'
      },
      {
        id: '3',
        title: 'Работа с отзывами',
        description: 'Систематическая работа с отзывами',
        tasks: [
          'Ответить на все отзывы',
          'Попросить довольных клиентов оставить отзыв',
          'Обработать негативные отзывы',
          'Создать программу рекомендаций',
          'Мониторить рейтинг'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост рейтинга до 4.5+, увеличение доверия на 40%'
      },
      {
        id: '4',
        title: 'Контент-маркетинг',
        description: 'Регулярная публикация контента',
        tasks: [
          'Публиковать новости',
          'Делиться полезной информацией',
          'Показывать результаты работ',
          'Анонсировать акции',
          'Рассказывать о команде'
        ],
        duration: 'Постоянно',
        expectedResult: 'Рост вовлеченности на 50%, увеличение повторных визитов на 20%'
      },
      {
        id: '5',
        title: 'Масштабирование',
        description: 'Расширение и автоматизация',
        tasks: [
          'Внедрить CRM',
          'Автоматизировать процессы',
          'Расширить команду',
          'Внедрить систему онлайн-записи',
          'Открыть новые точки'
        ],
        duration: '2-3 месяца',
        expectedResult: 'Рост выручки на 50-100%, увеличение клиентской базы в 2 раза'
      }
    ]
  }
];

export const GrowthPlan: React.FC = () => {
  const [selectedType, setSelectedType] = useState<string>('beauty_salon');
  const [expandedStages, setExpandedStages] = useState<Set<string>>(new Set(['1']));

  const selectedPlan = businessPlans.find(plan => plan.type === selectedType) || businessPlans[0];

  if (!selectedPlan) {
    return (
      <div className="bg-white rounded-lg shadow-md p-6">
        <p className="text-red-600">Ошибка: план для выбранного типа бизнеса не найден</p>
      </div>
    );
  }

  const toggleStage = (stageId: string) => {
    setExpandedStages(prev => {
      const newSet = new Set(prev);
      if (newSet.has(stageId)) {
        newSet.delete(stageId);
      } else {
        newSet.add(stageId);
      }
      return newSet;
    });
  };

  return (
    <div className="space-y-6">
      <div className="bg-white rounded-lg shadow-md p-6">
        <h2 className="text-2xl font-bold text-gray-900 mb-4">Схема роста бизнеса</h2>
        <p className="text-gray-600 mb-6">
          Выберите тип бизнеса, чтобы увидеть пошаговый план развития
        </p>

        <div className="mb-6">
          <label className="block text-sm font-medium text-gray-700 mb-2">
            Тип бизнеса
          </label>
          <Select value={selectedType} onValueChange={setSelectedType}>
            <SelectTrigger className="w-full max-w-md">
              <SelectValue />
            </SelectTrigger>
            <SelectContent>
              {businessPlans.map(plan => (
                <SelectItem key={plan.type} value={plan.type}>
                  {plan.label}
                </SelectItem>
              ))}
            </SelectContent>
          </Select>
        </div>

        <div className="space-y-4">
          {selectedPlan.stages.map((stage, index) => {
            const isExpanded = expandedStages.has(stage.id);
            const isCompleted = index < expandedStages.size - 1;

            return (
              <Card key={stage.id} className="border-2 border-primary shadow-lg">
                <CardHeader>
                  <div className="flex items-start justify-between">
                    <div className="flex items-start space-x-3 flex-1">
                      <div className="mt-1">
                        {isCompleted ? (
                          <CheckCircle2 className="h-6 w-6 text-green-500" />
                        ) : (
                          <Circle className="h-6 w-6 text-gray-400" />
                        )}
                      </div>
                      <div className="flex-1">
                        <CardTitle className="text-lg">{stage.title}</CardTitle>
                        <CardDescription className="mt-1">{stage.description}</CardDescription>
                      </div>
                    </div>
                    <Button
                      variant="ghost"
                      size="sm"
                      onClick={() => toggleStage(stage.id)}
                      className="ml-4"
                    >
                      {isExpanded ? 'Свернуть' : 'Развернуть'}
                      <ArrowRight
                        className={`ml-2 h-4 w-4 transition-transform ${
                          isExpanded ? 'rotate-90' : ''
                        }`}
                      />
                    </Button>
                  </div>
                </CardHeader>
                {isExpanded && (
                  <CardContent>
                    <div className="space-y-4">
                      <div>
                        <h4 className="font-semibold text-gray-900 mb-2">Задачи этапа:</h4>
                        <ul className="space-y-2">
                          {stage.tasks.map((task, taskIndex) => (
                            <li key={taskIndex} className="flex items-start space-x-2">
                              <span className="text-primary mt-1">•</span>
                              <span className="text-gray-700">{task}</span>
                            </li>
                          ))}
                        </ul>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t">
                        <div>
                          <span className="text-sm font-medium text-gray-500">Длительность:</span>
                          <p className="text-gray-900 font-semibold">{stage.duration}</p>
                        </div>
                        <div>
                          <span className="text-sm font-medium text-gray-500">Ожидаемый результат:</span>
                          <p className="text-gray-900 font-semibold">{stage.expectedResult}</p>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                )}
              </Card>
            );
          })}
        </div>
      </div>
    </div>
  );
};

