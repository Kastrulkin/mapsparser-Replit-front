## Задача: UI для управления прокси в админ-панели

**Дата:** 2025-01-03  
**Приоритет:** Средний  
**Исполнитель:** Кодер (Frontend)

---

## Цель

Сделать удобный интерфейс для суперадмина для:
- Просмотра списка прокси
- Добавления новых прокси
- Удаления/деактивации прокси
- Просмотра статуса (работает/не работает, статистика)

---

## Где размещаем

**Страница:** `AdminPage` (суперадмин)  
**Файл:** `frontend/src/pages/dashboard/AdminPage.tsx`  

Добавить новую вкладку в верхний таббар админ-панели:
- Название вкладки: **\"Прокси\"**
- Иконка: `Network` (уже импортирован в AdminPage)

---

## Новый компонент: ProxyManagement

**Файл:** `frontend/src/components/ProxyManagement.tsx`

### Функциональность

1. **Список прокси**
   - Таблица/карточки со столбцами:
     - Хост:порт
     - Тип (http/socks5)
     - Активен (is_active)
     - Работает (is_working)
     - Успешных запросов (success_count)
     - Ошибок (failure_count)
     - Последнее использование (last_used_at)
   - Цветовые статусы:
     - Зеленый — работает
     - Красный — не работает
     - Серый — не активен

2. **Добавление прокси**
   - Форма:
     - Тип: select (`http`, `socks5`)
     - Host (строка)
     - Port (число)
     - Username (опционально)
     - Password (опционально)
   - Кнопка \"Добавить прокси\"
   - После успешного добавления — обновить список

3. **Удаление/деактивация**
   - Кнопка \"Удалить\" для каждого прокси
   - Запрос подтверждения перед удалением
   - Альтернатива: флаг `is_active` (можно сделать позже)

---

## API эндпоинты (Backend)

Использовать эндпоинты из `TASK_IP_ROTATION.md`:

- `GET /api/admin/proxies` — список прокси
- `POST /api/admin/proxies` — добавление прокси
- `DELETE /api/admin/proxies/:proxy_id` — удаление прокси

Формат ответа `GET /api/admin/proxies`:
- `id`
- `type`
- `host`
- `port`
- `is_active`
- `is_working`
- `success_count`
- `failure_count`
- `last_used_at`
- `last_checked_at`

---

## Интеграция в AdminPage

**Файл:** `frontend/src/pages/dashboard/AdminPage.tsx`

### 1. Состояние вкладок

Добавить новое значение в `activeTab`:
- `'proxies'`

Добавить кнопку таба:
- Текст: `Прокси`
- Иконка: `Network`
- Только для суперадмина (`user.is_superadmin === true`)

### 2. Рендер вкладки

В блоке:

```tsx
{activeTab === 'agents' ? (
  <AIAgentsManagement />
) : activeTab === 'tokens' ? (
  <TokenUsageStats />
) : activeTab === 'growth' ? (
  <GrowthPlanEditor />
) : activeTab === 'prompts' ? (
  <PromptsManagement />
) : (
  ...
)}
```

Добавить ветку:

```tsx
) : activeTab === 'proxies' ? (
  <ProxyManagement />
) : (
```

---

## UX детали

- Показать предупреждение, если список прокси пуст:
  - Текст: \"Прокси не настроены. Добавьте хотя бы один прокси, чтобы включить ротацию IP.\"
- Подсказка:
  - Ссылка на `TASK_IP_ROTATION.md` или краткие инструкции:
    - Для теста можно добавить бесплатный прокси
    - Для продакшена — использовать резидентные прокси

---

## Чеклист для фронтенд-кодера

- [ ] Создать компонент `ProxyManagement.tsx` в `frontend/src/components/`
  - [ ] Отрисовать список прокси
  - [ ] Реализовать запросы к API (`GET/POST/DELETE /api/admin/proxies`)
  - [ ] Поддержать состояния загрузки/ошибок
  - [ ] Добавить форму добавления прокси
- [ ] Интегрировать `ProxyManagement` в `AdminPage.tsx`
  - [ ] Добавить вкладку \"Прокси\" только для суперадмина
  - [ ] Добавить рендер компонента при `activeTab === 'proxies'`
- [ ] Протестировать:
  - [ ] Добавление рабочего прокси
  - [ ] Удаление прокси
  - [ ] Отображение статусов (is_working, success/failure)


